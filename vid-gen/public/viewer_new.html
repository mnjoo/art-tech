<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Viewer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body class="bg-black flex items-center justify-center h-screen">
  <div id="media-container" class="w-full h-full flex items-center justify-center"></div>

  <script>
    const socket = io();
    const container = document.getElementById('media-container');
    let index = 0;
    let mediaList = [];

    function showNext() {
      if (mediaList.length === 0) return;

      const file = mediaList[index];
      container.innerHTML = '';

      let el;
      if (file.match(/\.(jpg|jpeg|png|gif)$/)) {
        el = document.createElement('img');
        el.src = file;
        el.className = 'max-h-screen max-w-full';
      } else if (file.match(/\.(mp4|webm|ogg)$/)) {
        el = document.createElement('video');
        el.src = file;
        el.className = 'max-h-screen max-w-full';
        el.autoplay = true;
        el.controls = false;
      }

      if (el) container.appendChild(el);
      index = (index + 1) % mediaList.length;

      setTimeout(showNext, 2000); // 5 seconds per media
    }

    socket.on('media-files', (files) => {
      mediaList = files;
      index = 0;
      showNext();
    });

    socket.on('show-playlist', (playlistId) => {
    container.innerHTML = '';
    const iframe = document.createElement('iframe');
    iframe.width = "100%";
    iframe.height = "100%";
    iframe.src = `https://www.youtube.com/embed?listType=playlist&list=${playlistId}&autoplay=1&loop=1&rel=0&modestbranding=1`;
    iframe.allow = "autoplay; encrypted-media";
    iframe.allowFullscreen = true;
    container.appendChild(iframe);
  });
  
  </script>
</body>
</html>



